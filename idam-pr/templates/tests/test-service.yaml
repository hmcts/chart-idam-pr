apiVersion: v1
kind: Pod
metadata:
  name: {{ template "hmcts.releaseName" . }}-bin-test-service
  labels:
    app.kubernetes.io/name: {{ template "hmcts.releaseName" . }}-bin-test-service
    helm.sh/chart: "{{ .Chart.Name }}-{{ .Chart.Version }}"
    app.kubernetes.io/managed-by: {{ .Release.Service | quote }}
    app.kubernetes.io/instance: {{ .Release.Name | quote }}
  annotations:
    helm.sh/hook: test-success
    helm.sh/hook-delete-policy: "before-hook-creation"
spec:
  volumes:
    - name: container-init
      configMap:
        name: {{ template "hmcts.releaseName" . }}-bin-test
        defaultMode: 0755
  containers:
  - name: {{ template "hmcts.releaseName" . }}-bin-test
    image: hmcts/curl
    volumeMounts:
      - name: container-init
        mountPath: /container.init
    command: [ "/bin/sh" ]
    args:
      - /container.init/idam-pr-test
  restartPolicy: Never
